#!/usr/bin/env perl
use strict;
use warnings;
use File::Path;
use Getopt::Long;
use GitGraph;

GetOptions( \my %conf, 'debug!', 'verbose!' )
    or die "Usage: $0 [ --debug ] [ --verbose ]";

my $depth = shift || 0;

init('cayley') if !-e 'cayley';
set_git_repo('cayley');

sub cayley {
    my ( $branch, $n, $root ) = @_;

    # create node
    return node($branch) if !$n;

    # branches
    my @nodes = (
        cayley( $branch, $n - 1 ),
        cayley( $branch, $n - 1 ),
        cayley( $branch, $n - 1 )
    );
    push @nodes, cayley( $branch, $n - 1 ) if $root;    # first item
    return node( $branch, @nodes);
}

cayley( "cayley-$depth", $depth, 1 );

